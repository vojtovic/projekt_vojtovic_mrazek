"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[5895],{857:(le,F,a)=>{a.r(F),a.d(F,{SettingsPage:()=>Sn,default:()=>Jn});var e=a(53547),S=a(68547),s=a(49656),q=a(35395),V=a(97132),Ge=a(15482),we=a(32104),Se=a(58836),He=a(23724),ae=a(80117),B=a(94117),A=a(39272),Y=a(33483),Pe=a(9524),K=a(64459),re=a(10407),pt=a(74657),lt=a.n(pt),et=a(22754),xe=a.n(et),ee=a(45697),E=a.n(ee),ve=a(27987),tt=a(49549),nt=a(89326),ce=a.n(nt),Ce=a(79274),Ee=a.n(Ce),ot=a(8041);const ct={currentStep:void 0},Xe=(c=ct,d)=>(0,ot.default)(c,l=>{switch(d.type){case"GO_TO":{l.currentStep=d.to;break}default:return l}});var Be=a(68991);const at={localImage:void 0},pe=(c=at,d)=>(0,ot.default)(c,l=>{switch(d.type){case"SET_LOCAL_IMAGE":{l.localImage=d.value;break}default:return l}}),j=({onChangeLogo:c,customLogo:d,goTo:l,Component:f,modalTitle:b,next:p,prev:w,currentStep:T})=>{const[{localImage:v},x]=(0,e.useReducer)(pe,at),{formatMessage:_}=(0,V.useIntl)(),Re=$e=>{x({type:"SET_LOCAL_IMAGE",value:$e})},Oe=()=>{l(null)};return T?e.createElement(Be.ModalLayout,{labelledBy:"modal",onClose:Oe},e.createElement(Be.ModalHeader,null,e.createElement(Y.Typography,{fontWeight:"bold",as:"h2",id:"modal"},_(b))),e.createElement(f,{setLocalImage:Re,goTo:l,next:p,prev:w,onClose:Oe,asset:v||d,onChangeLogo:c})):null};j.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},j.propTypes={Component:E().elementType,currentStep:E().string,customLogo:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}),goTo:E().func.isRequired,modalTitle:E().shape({id:E().string,defaultMessage:E().string}),next:E().string,onChangeLogo:E().func.isRequired,prev:E().string};const de=j,D=750,ie=100,me=["image/jpeg","image/png","image/svg+xml"];var Q=a(1738),ge=a(97833),J=a(78384),H=a(40264),ue=a(33699),We=a(16572),rt=a(96053),st=a.n(rt),Ct=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const gt={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},U={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},fe=c=>new Promise(d=>{const l=new FileReader;l.onload=()=>{const f=new Image;f.onload=function(){d({width:f.width,height:f.height})},f.src=l.result},l.readAsDataURL(c)}),X=(c,d)=>({ext:c.name.split(".").pop(),size:c.size/1e3,name:c.name,url:URL.createObjectURL(c),rawFile:c,width:d.width,height:d.height}),y=c=>Ct(void 0,null,function*(){let d;if(!me.includes(c.type))throw d=new Error("File format"),d.displayMessage=gt,d;const f=yield fe(c);if(!(f.width<=D&&f.height<=D))throw d=new Error("File sizing"),d.displayMessage=U,d;const p=X(c,f);if(!(p.size<=ie))throw d=new Error("File sizing"),d.displayMessage=U,d;return p});var Ye=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const Qe=(0,J.default)(We.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,dt=({setLocalImage:c,goTo:d,next:l,onClose:f})=>{const{formatMessage:b}=(0,V.useIntl)(),[p,w]=(0,e.useState)(!1),[T,v]=(0,e.useState)(void 0),x=(0,e.useRef)(null),_=()=>w(!0),Re=()=>w(!1),Oe=qe=>{qe.preventDefault(),x.current.click()},$e=()=>Ye(void 0,null,function*(){Re();const qe=x.current.files[0];if(!!qe)try{const Ze=yield y(qe);c(Ze),d(l)}catch(Ze){if(Ze.displayMessage)v(b(Ze.displayMessage,{size:ie,dimension:D})),x.current.focus();else throw Ze}}),Je=()=>p?"primary500":T?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(We.Field,{name:"logo-upload",error:T},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(Pe.Stack,{spacing:2},e.createElement(H.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:p?"primary100":"neutral100",borderColor:Je(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:_,onDragLeave:Re},e.createElement(ue.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:st(),"aria-hidden":!0}),e.createElement(B.Box,{paddingTop:3,paddingBottom:5},e.createElement(Y.Typography,{variant:"delta",as:"span"},b({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(Qe,{accept:me,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:$e,ref:x,id:"logo-upload"}),e.createElement(K.Button,{type:"button",onClick:Oe},b({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(B.Box,{paddingTop:6},e.createElement(Y.Typography,{variant:"pi",textColor:"neutral600"},b({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:ie,dimension:D})))),e.createElement(We.FieldError,null)))))),e.createElement(Be.ModalFooter,{startActions:e.createElement(K.Button,{onClick:f,variant:"tertiary"},b({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};dt.defaultProps={next:null},dt.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const oe=dt;var Ae=a(99136),Me=a(9669),Rn=a.n(Me),Ln=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const tn=c=>Ln(void 0,null,function*(){try{const d=yield Rn().get(c,{responseType:"blob",timeout:8e3});return new File([d.data],d.config.url,{type:d.headers["content-type"]})}catch(d){throw d.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},d}});var nn=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const Bt=({goTo:c,next:d,onClose:l,setLocalImage:f})=>{const{formatMessage:b}=(0,V.useIntl)(),[p,w]=(0,e.useState)(""),[T,v]=(0,e.useState)(null),x=Re=>{w(Re.target.value)},_=Re=>nn(void 0,null,function*(){Re.preventDefault();try{const Oe=yield tn(p),$e=yield y(Oe);f($e),c(d)}catch(Oe){if(Oe.displayMessage)v(b(Oe.displayMessage,{size:ie,dimension:D}));else throw Oe}});return e.createElement("form",{onSubmit:_},e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Ae.TextInput,{label:b({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:T,onChange:x,value:p,name:"logo-url"})),e.createElement(Be.ModalFooter,{startActions:e.createElement(K.Button,{onClick:l,variant:"tertiary"},b({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(K.Button,{type:"submit"},b({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};Bt.defaultProps={next:null},Bt.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const lo=Bt,At=({setLocalImage:c,goTo:d,next:l,onClose:f})=>{const{formatMessage:b}=(0,V.useIntl)();return e.createElement(Q.TabGroup,{label:b({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(B.Box,{paddingLeft:8,paddingRight:8},e.createElement(Q.Tabs,null,e.createElement(Q.Tab,null,b({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(Q.Tab,null,b({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(ge.Divider,null)),e.createElement(Q.TabPanels,null,e.createElement(Q.TabPanel,null,e.createElement(oe,{onClose:f,setLocalImage:c,goTo:d,next:l})),e.createElement(Q.TabPanel,null,e.createElement(lo,{onClose:f,setLocalImage:c,goTo:d,next:l}))))};At.defaultProps={next:null},At.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const co=At;var yt=a(14621);const on=({asset:c})=>{const{formatMessage:d}=(0,V.useIntl)();return e.createElement(yt.Card,null,e.createElement(yt.CardHeader,null,e.createElement(yt.CardAsset,{size:"S",src:c.url})),e.createElement(yt.CardBody,null,e.createElement(yt.CardContent,null,e.createElement(yt.CardTitle,null,c.name),e.createElement(yt.CardSubtitle,null,`${c.ext.toUpperCase()} - ${c.width}\u2715${c.height}`)),e.createElement(yt.CardBadge,null,d({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};on.propTypes={asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired};const an=on,Ut=({onClose:c,asset:d,prev:l,next:f,goTo:b,setLocalImage:p,onChangeLogo:w})=>{const{formatMessage:T}=(0,V.useIntl)(),v=()=>{p(void 0),b(l)},x=()=>{w(d),b(f)};return e.createElement(e.Fragment,null,e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(H.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(H.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(Y.Typography,{variant:"pi",fontWeight:"bold"},T({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(Y.Typography,{variant:"pi",textColor:"neutral500"},T({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(K.Button,{onClick:v,variant:"secondary"},T({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(B.Box,{maxWidth:(0,S.pxToRem)(180)},e.createElement(an,{asset:d}))),e.createElement(Be.ModalFooter,{startActions:e.createElement(K.Button,{onClick:c,variant:"tertiary"},T({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(K.Button,{onClick:x},T({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Ut.defaultProps={next:null,prev:null},Ut.propTypes={goTo:E().func.isRequired,asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired,next:E().string,onClose:E().func.isRequired,onChangeLogo:E().func.isRequired,prev:E().string,setLocalImage:E().func.isRequired};const Mn={upload:{Component:co,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Ut,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Rt=({customLogo:c,defaultLogo:d,onChangeLogo:l,onResetMenuLogo:f})=>{const[{currentStep:b},p]=(0,e.useReducer)(Xe,ct),{Component:w,next:T,prev:v,modalTitle:x}=Mn[b]||{},{formatMessage:_}=(0,V.useIntl)(),Re=Oe=>{p({type:"GO_TO",to:Oe})};return e.createElement(e.Fragment,null,e.createElement(ve.CarouselInput,{label:_({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"}),selectedSlide:0,hint:_({id:"Settings.application.customization.carousel-hint",defaultMessage:"Change the admin panel logo (Max dimension: {dimension}x{dimension}, Max file size: {size}KB)"},{size:ie,dimension:D}),previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:(c==null?void 0:c.name)||"logo.png",actions:e.createElement(ve.CarouselActions,null,e.createElement(tt.IconButton,{onClick:()=>Re(c?"pending":"upload"),label:_({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(ce(),null)}),c&&e.createElement(tt.IconButton,{onClick:f,label:_({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(Ee(),null)}))},e.createElement(ve.CarouselSlide,{label:_({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(B.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:(c==null?void 0:c.url)||d,alt:_({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(de,{Component:w,currentStep:b,onChangeLogo:l,customLogo:c,goTo:Re,next:T,prev:v,modalTitle:x}))};Rt.defaultProps={customLogo:null},Rt.propTypes={customLogo:E().shape({url:E().string,name:E().string}),defaultLogo:E().string.isRequired,onChangeLogo:E().func.isRequired,onResetMenuLogo:E().func.isRequired};const rn=Rt,jt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}}},po=(c=jt,d)=>(0,ot.default)(c,l=>{switch(d.type){case"SET_CUSTOM_MENU_LOGO":{l.menuLogo.display=d.value,l.menuLogo.submit.rawFile=d.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{l.menuLogo.display=null,l.menuLogo.submit={rawFile:null,isReset:!0};break}default:return l}});var Gt=a(82492),mo=a.n(Gt);const go=(c,d)=>mo()(c,{menuLogo:{display:d.menuLogo}}),Zt=(0,e.forwardRef)(({projectSettingsStored:c},d)=>{const{formatMessage:l}=(0,V.useIntl)(),{trackUsage:f}=(0,S.useTracking)(),{logos:{menu:b}}=(0,we.um)(),[{menuLogo:p},w]=(0,e.useReducer)(po,jt,()=>go(jt,c)),T=x=>{w({type:"SET_CUSTOM_MENU_LOGO",value:x})},v=()=>{f("didClickResetLogo"),w({type:"RESET_CUSTOM_MENU_LOGO"})};return(0,e.useImperativeHandle)(d,()=>({getValues:()=>({menuLogo:p.submit})})),e.createElement(B.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(Y.Typography,{variant:"delta",as:"h3"},l({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(A.Grid,{paddingTop:4},e.createElement(A.GridItem,{col:6,s:12},e.createElement(rn,{onChangeLogo:T,customLogo:p.display,defaultLogo:b.default,onResetMenuLogo:v}))))});Zt.defaultProps={projectSettingsStored:null},Zt.propTypes={projectSettingsStored:E().shape({menuLogo:E().shape({url:E().string,name:E().string})})};const In=Zt;var sn=a(63955),fo=a(68718),Dt=a.n(fo),ho=Object.defineProperty,xt=Object.defineProperties,ln=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertySymbols,cn=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,zt=(c,d,l)=>d in c?ho(c,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[d]=l,dn=(c,d)=>{for(var l in d||(d={}))cn.call(d,l)&&zt(c,l,d[l]);if(Vt)for(var l of Vt(d))Fn.call(d,l)&&zt(c,l,d[l]);return c},un=(c,d)=>xt(c,ln(d));const Kt=c=>Dt()(c,(d,l,f)=>{l&&l.url?d[f]=un(dn({},l),{url:(0,S.prefixFileUrlWithBackendUrl)(l.url)}):d[f]=l},{});var pn=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const vo=()=>pn(void 0,null,function*(){const{data:c}=yield sn.be.get("/admin/project-settings");return Kt(c)}),wn=c=>pn(void 0,null,function*(){const{data:d}=yield sn.be.post("/admin/project-settings",c);return Kt(d)}),jn=c=>{const d=new FormData;return Object.entries(c).forEach(([l,f])=>{f&&f.rawFile instanceof File&&d.append(l,f.rawFile),f&&f.isReset&&d.append(l,null)}),d};var mn=(c,d,l)=>new Promise((f,b)=>{var p=v=>{try{T(l.next(v))}catch(x){b(x)}},w=v=>{try{T(l.throw(v))}catch(x){b(x)}},T=v=>v.done?f(v.value):Promise.resolve(v.value).then(p,w);T((l=l.apply(c,d)).next())});const Nn=[{action:"admin::project-settings.update",subject:null}],Eo=()=>{const c=(0,e.useRef)(),d=(0,S.useNotification)(),{trackUsage:l}=(0,S.useTracking)(),{formatMessage:f}=(0,V.useIntl)(),b=(0,He.useQueryClient)();(0,S.useFocusWhenNavigate)();const p=(0,S.useAppInfos)(),{shouldUpdateStrapi:w,latestStrapiReleaseTag:T,strapiVersion:v}=p,{updateProjectSettings:x}=(0,we.um)(),{data:_}=(0,He.useQuery)("project-settings",vo),Re=p.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",Oe=(0,He.useMutation)(Je=>wn(Je),{onSuccess:Je=>mn(void 0,[Je],function*({menuLogo:qe}){yield b.invalidateQueries("project-settings",{refetchActive:!0}),x({menuLogo:qe==null?void 0:qe.url})})}),$e=()=>{const Je=c.current.getValues(),qe=jn(Je);Oe.mutate(qe,{onSuccess:()=>{const{menuLogo:Ze}=Je;Ze.rawFile&&l("didChangeLogo")},onError:()=>{d({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(q.Layout,null,e.createElement(S.SettingsPageTitle,{name:"Application"}),e.createElement(ae.Main,null,e.createElement(q.HeaderLayout,{title:f({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:f({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:e.createElement(K.Button,{onClick:$e,startIcon:e.createElement(xe(),null)},f({id:"global.save",defaultMessage:"Save"}))}),e.createElement(q.ContentLayout,null,e.createElement(Pe.Stack,{spacing:6},e.createElement(B.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(Pe.Stack,{spacing:5},e.createElement(Y.Typography,{variant:"delta",as:"h3"},f({id:"global.details",defaultMessage:"Details"})),e.createElement(A.Grid,{paddingTop:1},e.createElement(A.GridItem,{col:6,s:12},e.createElement(Y.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(Y.Typography,{as:"p"},"v",v),e.createElement(re.Link,{href:p.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(lt(),null)},f({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(A.GridItem,{col:6,s:12},e.createElement(Y.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(Y.Typography,{as:"p"},f({id:Re,defaultMessage:`${p.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(A.Grid,{paddingTop:1},e.createElement(A.GridItem,{col:6,s:12},w&&e.createElement(re.Link,{href:`https://github.com/strapi/strapi/releases/tag/${T}`,isExternal:!0,endIcon:e.createElement(lt(),null)},f({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(A.GridItem,{col:6,s:12},e.createElement(re.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(lt(),null)},f({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(B.Box,{paddingTop:1},e.createElement(Y.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(Y.Typography,{as:"p"},p.nodeVersion)))),_&&e.createElement(S.CheckPermissions,{permissions:Nn},e.createElement(In,{ref:c,projectSettingsStored:_}))))))};var gn=a(94654),kn=a.n(gn);const Wn=c=>kn()(c,l=>l.links).map(l=>(0,Se.ot)(l.Component,l.to,l.exact||!1)),Un=c=>c.filter(d=>!d.links.every(l=>l.isDisplayed===!1));var fn=a(42982),hn=a(71002),vt=a(15861);function Te(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Te=function(){return c};var c={},d=Object.prototype,l=d.hasOwnProperty,f=typeof Symbol=="function"?Symbol:{},b=f.iterator||"@@iterator",p=f.asyncIterator||"@@asyncIterator",w=f.toStringTag||"@@toStringTag";function T(C,g,L){return Object.defineProperty(C,g,{value:L,enumerable:!0,configurable:!0,writable:!0}),C[g]}try{T({},"")}catch(C){T=function(L,I,$){return L[I]=$}}function v(C,g,L,I){var $=g&&g.prototype instanceof Re?g:Re,Z=Object.create($.prototype),he=new Jt(I||[]);return Z._invoke=function(ut,ft,ne){var Ie="suspendedStart";return function(ht,_t){if(Ie==="executing")throw new Error("Generator is already running");if(Ie==="completed"){if(ht==="throw")throw _t;return qt()}for(ne.method=ht,ne.arg=_t;;){var On=ne.delegate;if(On){var It=Pn(On,ne);if(It){if(It===_)continue;return It}}if(ne.method==="next")ne.sent=ne._sent=ne.arg;else if(ne.method==="throw"){if(Ie==="suspendedStart")throw Ie="completed",ne.arg;ne.dispatchException(ne.arg)}else ne.method==="return"&&ne.abrupt("return",ne.arg);Ie="executing";var Tt=x(ut,ft,ne);if(Tt.type==="normal"){if(Ie=ne.done?"completed":"suspendedYield",Tt.arg===_)continue;return{value:Tt.arg,done:ne.done}}Tt.type==="throw"&&(Ie="completed",ne.method="throw",ne.arg=Tt.arg)}}}(C,L,he),Z}function x(C,g,L){try{return{type:"normal",arg:C.call(g,L)}}catch(I){return{type:"throw",arg:I}}}c.wrap=v;var _={};function Re(){}function Oe(){}function $e(){}var Je={};T(Je,b,function(){return this});var qe=Object.getPrototypeOf,Ze=qe&&qe(qe(kt([])));Ze&&Ze!==d&&l.call(Ze,b)&&(Je=Ze);var Pt=$e.prototype=Re.prototype=Object.create(Je);function qn(C){["next","throw","return"].forEach(function(g){T(C,g,function(L){return this._invoke(g,L)})})}function Nt(C,g){function L($,Z,he,ut){var ft=x(C[$],C,Z);if(ft.type!=="throw"){var ne=ft.arg,Ie=ne.value;return Ie&&(0,hn.Z)(Ie)=="object"&&l.call(Ie,"__await")?g.resolve(Ie.__await).then(function(ht){L("next",ht,he,ut)},function(ht){L("throw",ht,he,ut)}):g.resolve(Ie).then(function(ht){ne.value=ht,he(ne)},function(ht){return L("throw",ht,he,ut)})}ut(ft.arg)}var I;this._invoke=function($,Z){function he(){return new g(function(ut,ft){L($,Z,ut,ft)})}return I=I?I.then(he,he):he()}}function Pn(C,g){var L=C.iterator[g.method];if(L===void 0){if(g.delegate=null,g.method==="throw"){if(C.iterator.return&&(g.method="return",g.arg=void 0,Pn(C,g),g.method==="throw"))return _;g.method="throw",g.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var I=x(L,C.iterator,g.arg);if(I.type==="throw")return g.method="throw",g.arg=I.arg,g.delegate=null,_;var $=I.arg;return $?$.done?(g[C.resultName]=$.value,g.next=C.nextLoc,g.method!=="return"&&(g.method="next",g.arg=void 0),g.delegate=null,_):$:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,_)}function Tn(C){var g={tryLoc:C[0]};1 in C&&(g.catchLoc=C[1]),2 in C&&(g.finallyLoc=C[2],g.afterLoc=C[3]),this.tryEntries.push(g)}function Qt(C){var g=C.completion||{};g.type="normal",delete g.arg,C.completion=g}function Jt(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(Tn,this),this.reset(!0)}function kt(C){if(C){var g=C[b];if(g)return g.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var L=-1,I=function $(){for(;++L<C.length;)if(l.call(C,L))return $.value=C[L],$.done=!1,$;return $.value=void 0,$.done=!0,$};return I.next=I}}return{next:qt}}function qt(){return{value:void 0,done:!0}}return Oe.prototype=$e,T(Pt,"constructor",$e),T($e,"constructor",Oe),Oe.displayName=T($e,w,"GeneratorFunction"),c.isGeneratorFunction=function(C){var g=typeof C=="function"&&C.constructor;return!!g&&(g===Oe||(g.displayName||g.name)==="GeneratorFunction")},c.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,$e):(C.__proto__=$e,T(C,w,"GeneratorFunction")),C.prototype=Object.create(Pt),C},c.awrap=function(C){return{__await:C}},qn(Nt.prototype),T(Nt.prototype,p,function(){return this}),c.AsyncIterator=Nt,c.async=function(C,g,L,I,$){$===void 0&&($=Promise);var Z=new Nt(v(C,g,L,I),$);return c.isGeneratorFunction(g)?Z:Z.next().then(function(he){return he.done?he.value:Z.next()})},qn(Pt),T(Pt,w,"Generator"),T(Pt,b,function(){return this}),T(Pt,"toString",function(){return"[object Generator]"}),c.keys=function(C){var g=[];for(var L in C)g.push(L);return g.reverse(),function I(){for(;g.length;){var $=g.pop();if($ in C)return I.value=$,I.done=!1,I}return I.done=!0,I}},c.values=kt,Jt.prototype={constructor:Jt,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Qt),!g)for(var L in this)L.charAt(0)==="t"&&l.call(this,L)&&!isNaN(+L.slice(1))&&(this[L]=void 0)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if(g.type==="throw")throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var L=this;function I(ne,Ie){return he.type="throw",he.arg=g,L.next=ne,Ie&&(L.method="next",L.arg=void 0),!!Ie}for(var $=this.tryEntries.length-1;$>=0;--$){var Z=this.tryEntries[$],he=Z.completion;if(Z.tryLoc==="root")return I("end");if(Z.tryLoc<=this.prev){var ut=l.call(Z,"catchLoc"),ft=l.call(Z,"finallyLoc");if(ut&&ft){if(this.prev<Z.catchLoc)return I(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return I(Z.finallyLoc)}else if(ut){if(this.prev<Z.catchLoc)return I(Z.catchLoc,!0)}else{if(!ft)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return I(Z.finallyLoc)}}}},abrupt:function(g,L){for(var I=this.tryEntries.length-1;I>=0;--I){var $=this.tryEntries[I];if($.tryLoc<=this.prev&&l.call($,"finallyLoc")&&this.prev<$.finallyLoc){var Z=$;break}}Z&&(g==="break"||g==="continue")&&Z.tryLoc<=L&&L<=Z.finallyLoc&&(Z=null);var he=Z?Z.completion:{};return he.type=g,he.arg=L,Z?(this.method="next",this.next=Z.finallyLoc,_):this.complete(he)},complete:function(g,L){if(g.type==="throw")throw g.arg;return g.type==="break"||g.type==="continue"?this.next=g.arg:g.type==="return"?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):g.type==="normal"&&L&&(this.next=L),_},finish:function(g){for(var L=this.tryEntries.length-1;L>=0;--L){var I=this.tryEntries[L];if(I.finallyLoc===g)return this.complete(I.completion,I.afterLoc),Qt(I),_}},catch:function(g){for(var L=this.tryEntries.length-1;L>=0;--L){var I=this.tryEntries[L];if(I.tryLoc===g){var $=I.completion;if($.type==="throw"){var Z=$.arg;Qt(I)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(g,L,I){return this.delegate={iterator:kt(g),resultName:L,nextLoc:I},this.method==="next"&&(this.arg=void 0),_}},c}var Gn=function(){return window&&window.strapi&&window.strapi.isEE?a(18290).Z:a(56368).Z}(),Zn=function(){return window&&window.strapi&&window.strapi.isEE?a(28099).Z:a(73044).Z}(),Vn=[{Component:function(){return{default:Zn}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Gn}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Gn}},to:"/settings/roles/new",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(2544).then(a.bind(a,50287));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/roles/:id",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(5199).then(a.bind(a,61322));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/users",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(4263).then(a.bind(a,86294));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/users/:id",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([a.e(8252),a.e(5162)]).then(a.bind(a,2937));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/webhooks/create",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([a.e(8252),a.e(5162)]).then(a.bind(a,27103));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/webhooks/:id",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(4121).then(a.bind(a,77967));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/webhooks",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(8056).then(a.bind(a,81666));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/api-tokens",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(4299).then(a.bind(a,1424));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/api-tokens/create",exact:!0},{Component:function(){var c=(0,vt.Z)(Te().mark(function l(){var f;return Te().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.e(92).then(a.bind(a,51037));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function d(){return c.apply(this,arguments)}return d}(),to:"/settings/api-tokens/:id",exact:!0}];const zn=Vn;var yn=function(){return window&&window.strapi&&window.strapi.isEE?a(49475).Z:a(73258).Z}();const Kn=[].concat((0,fn.Z)(yn),(0,fn.Z)(zn));var Mt=a(95431),vn=Object.defineProperty,Hn=Object.defineProperties,Xn=Object.getOwnPropertyDescriptors,Cn=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Yn=Object.prototype.propertyIsEnumerable,Xt=(c,d,l)=>d in c?vn(c,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[d]=l,Yt=(c,d)=>{for(var l in d||(d={}))Ht.call(d,l)&&Xt(c,l,d[l]);if(Cn)for(var l of Cn(d))Yn.call(d,l)&&Xt(c,l,d[l]);return c},En=(c,d)=>Hn(c,Xn(d));const bn=({menu:c})=>{const{formatMessage:d}=(0,V.useIntl)(),f=Un(c).map(p=>En(Yt({},p),{title:p.intlLabel,links:p.links.map(w=>En(Yt({},w),{title:w.intlLabel,name:w.id}))})),b=d({id:"global.settings",defaultMessage:"Settings"});return e.createElement(Mt.SubNav,{ariaLabel:b},e.createElement(Mt.SubNavHeader,{label:b}),e.createElement(Mt.SubNavSections,null,f.map(p=>e.createElement(Mt.SubNavSection,{key:p.id,label:d(p.intlLabel)},p.links.map(w=>e.createElement(Mt.SubNavLink,{as:s.NavLink,withBullet:w.hasNotification,to:w.to,key:w.id},d(w.intlLabel)))))))};bn.propTypes={menu:E().array.isRequired};const Qn=bn;function Sn(){const{settingId:c}=(0,s.useParams)(),{settings:d}=(0,S.useStrapiApp)(),{formatMessage:l}=(0,V.useIntl)(),{isLoading:f,menu:b}=(0,we.Te)(),p=(0,e.useMemo)(()=>(0,Se.WW)(Kn.map(({to:v,Component:x,exact:_})=>(0,Se.ot)(x,v,_))),[]),w=Wn(d);if(f)return e.createElement(S.LoadingIndicatorPage,null);if(!c)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const T=l({id:"global.settings",defaultMessage:"Settings"});return e.createElement(q.Layout,{sideNav:e.createElement(Qn,{menu:b})},e.createElement(Ge.Helmet,{title:T}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:Eo,exact:!0}),p,w))}const Jn=(0,e.memo)(Sn)},56368:(le,F,a)=>{a.d(F,{Z:()=>q});var e=a(53547),S=a(49656);const q=()=>e.createElement(S.Redirect,{to:"/404"})},14934:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},48496:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},93485:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},55632:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},39672:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},79160:(le,F,a)=>{a.d(F,{Z:()=>_a});var e=a(53547),S=a(45697),s=a.n(S),q=a(68547),V=a(1738),Ge=a(18721),we=a.n(Ge),Se=a(41609),He=a.n(Se),ae=a(97132),B=a(94117),A=a(78384),Y=a(89734),Pe=a.n(Y),K=a(70885),re=a(32080),pt=a.n(re),lt=a(80499),et=a.n(lt),xe=a(46458),ee=a(40264),E=a(27361),ve=a.n(E),tt=a(57557),nt=a.n(tt),ce=a(32104),Ce=a(17581),Ee=a.n(Ce),ot=a(64459);const ct=A.default.div`
  position: relative;

  ${({hasConditions:o,disabled:t,theme:n})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${t?n.colors.neutral100:n.colors.primary600};
    }
  `}
`,mt=({onClick:o,className:t,hasConditions:n,variant:r})=>{const{formatMessage:i}=(0,ae.useIntl)();return e.createElement(ct,{hasConditions:n,className:t},e.createElement(ot.Button,{variant:r,startIcon:e.createElement(Ee(),null),onClick:o},i({id:"global.settings",defaultMessage:"Settings"})))};mt.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},mt.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const Xe=(0,A.default)(mt)``;var Be=a(97833),at=a(9524),Et=a(68991),pe=a(44981),j=a(33483),de=a(8041),D=a(7739),ie=a.n(D),me=a(11700),Q=a.n(me),ge=a(4942),J=a(42982),H=a(2632);const ue=`${120/16}rem`,We=`${200/16}rem`,rt=`${53/16}rem`;function st(o,t){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),n.push.apply(n,r)}return n}function Ct(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?st(Object(n),!0).forEach(function(r){(0,ge.Z)(o,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(n,r))})}return o}var gt=function(){return window&&window.strapi&&window.strapi.isEE?a(15272).Z:a(14934).Z}(),U=(0,A.default)(ee.Flex).withConfig({displayName:"ActionRow__FlexWrapper",componentId:"sc-1bqpgdl-0"})(["height:",";"],rt),fe=function(t){var n=t.arrayOfOptionsGroupedByCategory,r=t.isFormDisabled,i=t.isGrey,u=t.label,m=t.name,h=t.onChange,P=t.value,O=(0,ae.useIntl)(),R=O.formatMessage,N=n.reduce(function(W,G){var M=(0,K.Z)(G,2),k=M[0],te=M[1],ye={label:Q()(k),children:te.map(function(je){return{label:je.displayName,value:je.id}})};return[].concat((0,J.Z)(W),[ye])},[]),z=Object.values(P).map(function(W){return Object.entries(W).filter(function(G){var M=(0,K.Z)(G,2),k=M[1];return k}).map(function(G){var M=(0,K.Z)(G,1),k=M[0];return k})}).flat(),se=function(G){var M=(0,K.Z)(n,1),k=(0,K.Z)(M[0],2),te=k[1],ye=te.reduce(function(je,Le){return Ct((0,ge.Z)({},Le.id,G.includes(Le.id)),je)},{});h(m,ye)};return e.createElement(U,{as:"li",background:i?"neutral100":"neutral0"},e.createElement(ee.Flex,{paddingLeft:6,style:{width:180}},e.createElement(j.Typography,{variant:"sigma",textColor:"neutral600"},R({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(j.Typography,{variant:"sigma",title:u,textColor:"primary600",ellipsis:!0},R({id:"Settings.roles.form.permissions.".concat(u.toLowerCase()),defaultMessage:u})),e.createElement(j.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",R({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(B.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(H.MultiSelectNested,{id:m,customizeContent:function(G){return"".concat(G.length," currently selected")},onChange:se,value:z,options:N,disabled:r||gt})))};fe.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const X=fe;var y=a(96486);const Ye=(o,t)=>o.reduce((n,r)=>(n[r.id]=(0,y.get)(t,r.id,!1),n),{}),Qe=(o,t)=>o.reduce((n,r)=>{const[i,u]=r,m=Ye(u,t);return n[i]=m,n},{}),oe=(o,t,n)=>o.reduce((r,i)=>{const u=(0,y.get)(t,[...i.pathToConditionsObject,"conditions"],{}),m=Qe(n,u);return r[i.pathToConditionsObject.join("..")]=m,r},{});var Ae=Object.defineProperty,Me=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Ln=Object.prototype.propertyIsEnumerable,Dn=(o,t,n)=>t in o?Ae(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,tn=(o,t)=>{for(var n in t||(t={}))Rn.call(t,n)&&Dn(o,n,t[n]);if(Me)for(var n of Me(t))Ln.call(t,n)&&Dn(o,n,t[n]);return o};const nn=({actions:o,headerBreadCrumbs:t,isFormDisabled:n,onClosed:r,onToggle:i})=>{const{formatMessage:u}=(0,ae.useIntl)(),{availableConditions:m,modifiedData:h,onChangeConditions:P}=(0,ce.$_)(),O=(0,e.useMemo)(()=>Object.entries(ie()(m,"category")),[m]),R=o.filter(({isDisplayed:M,hasSomeActionsSelected:k,hasAllActionsSelected:te})=>M&&(k||te)),N=(0,e.useMemo)(()=>oe(R,h,O),[R,h,O]),[z,se]=(0,e.useState)(N),W=(M,k)=>{se((0,de.default)(te=>{te[M]||(te[M]={}),te[M].default||(te[M].default={}),te[M].default=k}))},G=()=>{const M=Object.entries(z).reduce((k,te)=>{const[ye,je]=te,Le=Object.values(je).reduce((Ne,Ve)=>tn(tn({},Ne),Ve),{});return k[ye]=Le,k},{});P(M),i()};return e.createElement(Et.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:r},e.createElement(Et.ModalHeader,null,e.createElement(pe.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:t.join(", ")},t.map(M=>e.createElement(pe.Crumb,{key:M},Q()(u({id:M,defaultMessage:M})))))),e.createElement(B.Box,{padding:8},e.createElement(at.Stack,{spacing:6},e.createElement(j.Typography,{variant:"beta",as:"h2"},u({id:"Settings.permissions.conditions.define-conditions",defaultMessage:"Define conditions"})),e.createElement(B.Box,null,e.createElement(Be.Divider,null)),e.createElement(B.Box,null,R.length===0&&e.createElement(j.Typography,null,u({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,R.map(({actionId:M,label:k,pathToConditionsObject:te},ye)=>{const je=te.join("..");return e.createElement(X,{key:M,arrayOfOptionsGroupedByCategory:O,label:k,isFormDisabled:n,isGrey:ye%2===0,name:je,onChange:W,value:ve()(z,je,{})})}))))),e.createElement(Et.ModalFooter,{startActions:e.createElement(ot.Button,{variant:"tertiary",onClick:i},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(ot.Button,{onClick:G},u({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};nn.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const Bt=nn,At=A.default.div`
  width: ${ue};
`,yt=(0,A.default)(ee.Flex)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`;var on=Object.defineProperty,an=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable,xn=(o,t,n)=>t in o?on(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Mn=(o,t)=>{for(var n in t||(t={}))Ut.call(t,n)&&xn(o,n,t[n]);if(an)for(var n of an(t))uo.call(t,n)&&xn(o,n,t[n]);return o};const Rt=({children:o,isCollapsable:t,isActive:n,isFormDisabled:r,label:i,onChange:u,onClick:m,checkboxName:h,someChecked:P,value:O})=>{const{formatMessage:R}=(0,ae.useIntl)();return e.createElement(ee.Flex,{alignItems:"center",paddingLeft:6,style:{width:We,flexShrink:0}},e.createElement(B.Box,{paddingRight:2},e.createElement(xe.BaseCheckbox,{name:h,"aria-label":R({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:i}),disabled:r,onValueChange:N=>u({target:{name:h,value:N}}),indeterminate:P,value:O})),e.createElement(yt,Mn({title:i,alignItems:"center",isCollapsable:t},t&&{onClick:m,"aria-expanded":n,onKeyDown:({key:N})=>(N==="Enter"||N===" ")&&m(),tabIndex:0,role:"button"}),e.createElement(j.Typography,{fontWeight:n?"bold":"",textColor:n?"primary600":"neutral800",ellipsis:!0},Q()(i)),o))};Rt.defaultProps={children:null,checkboxName:"",onChange:()=>{},value:!1,someChecked:!1,isCollapsable:!1},Rt.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const rn=(0,e.memo)(Rt),jt=o=>(0,y.isObject)(o)?(0,y.flattenDeep)(Object.values(o).map(t=>(0,y.isObject)(t)?jt(t):t)):[],Lt=jt,Gt=o=>o?Object.keys(o).reduce((t,n)=>(n!=="conditions"&&(t[n]=o[n]),t),{}):null,St=o=>{const t=Gt(o),n=Lt(t);if(!n.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const r=n.every(u=>u),i=n.some(u=>u)&&!r;return{hasAllActionsSelected:r,hasSomeActionsSelected:i}},Zt=(o,t,n)=>o.map(({actionId:r,isDisplayed:i,applyToProperties:u,label:m})=>{if(!i)return{actionId:r,hasSomeActionsSelected:!1,isDisplayed:i};const h=[...n.split(".."),r],P=(0,y.isEmpty)(u)?[...h,"properties","enabled"]:h,O=P.join(".."),R=(0,y.get)(t,[...h,"conditions"],null),N=Lt(R).some(G=>G);if((0,y.isEmpty)(u)){const G=(0,y.get)(t,P,!1);return{actionId:r,checkboxName:O,hasAllActionsSelected:G,hasConditions:N,hasSomeActionsSelected:G,isDisplayed:i,isParentCheckbox:!1,label:m,pathToConditionsObject:h}}const z=(0,y.get)(t,P,null),{hasAllActionsSelected:se,hasSomeActionsSelected:W}=St(z);return{actionId:r,checkboxName:O,hasAllActionsSelected:se,hasConditions:N,hasSomeActionsSelected:W,isDisplayed:i,isParentCheckbox:!0,label:m,pathToConditionsObject:h}});var In=a(40413),sn=a.n(In);const Dt=(0,A.default)(sn())`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,xt=o=>`
  ${j.Typography} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Dt} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var ln=function(){return window&&window.strapi&&window.strapi.isEE?a(43549).Z:a(55632).Z}(),Vt=function o(t,n){return`
  `.concat(cn,` {
    background-color: `).concat(t.colors.primary100,`;
    color: `).concat(t.colors.primary600,`;
    border-radius: `).concat(n?"2px 2px 0 0":"2px",`;
  }
  `).concat(dn,` {
    display: flex;
  }
  `).concat(Xe,` {
    display: block;
  }
  &:hover {
   `).concat(xt(t),`
  }

  &:focus-within {
    `).concat(function(r){var i=r.theme,u=r.isActive;return o(i,u)},`
  }
  
`)},cn=A.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],rt,function(o){var t=o.isGrey,n=o.theme;return t?n.colors.neutral100:n.colors.neutral0}),Fn=A.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],Xe,function(o){var t=o.isActive,n=o.theme;return t&&Vt(n,t)},function(o){var t=o.theme,n=o.isActive;return Vt(t,n)}),zt=(0,A.default)(ee.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],ue),dn=(0,A.default)(B.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var t=o.theme;return t.colors.primary600}),un=A.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var t=o.theme;return t.colors.primary600}),yo=(0,A.default)(B.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Kt=function(t){var n=t.availableActions,r=t.isActive,i=t.isGrey,u=t.isFormDisabled,m=t.label,h=t.onClickToggle,P=t.pathToData,O=(0,e.useState)(!1),R=(0,K.Z)(O,2),N=R[0],z=R[1],se=(0,ae.useIntl)(),W=se.formatMessage,G=(0,ce.$_)(),M=G.modifiedData,k=G.onChangeParentCheckbox,te=G.onChangeSimpleCheckbox,ye=function(){z(function(Fe){return!Fe})},je=function(){z(!1)},Le=ve()(M,P.split(".."),{}),Ne=(0,e.useMemo)(function(){return Object.keys(Le).reduce(function(be,Fe){return be[Fe]=nt()(Le[Fe],"conditions"),be},{})},[Le]),Ve=St(Ne),Ue=Ve.hasAllActionsSelected,Ft=Ve.hasSomeActionsSelected,De=(0,e.useMemo)(function(){return Zt(n,M,P)},[n,M,P]),ze=De.some(function(be){var Fe=be.hasConditions;return Fe});return e.createElement(Fn,{isActive:r},e.createElement(cn,{isGrey:i},e.createElement(rn,{isCollapsable:!0,isFormDisabled:u,label:m,checkboxName:P,onChange:k,onClick:h,someChecked:Ft,value:Ue,isActive:r},e.createElement(dn,{paddingLeft:2},r?e.createElement(et(),null):e.createElement(pt(),null))),e.createElement(ee.Flex,{style:{flex:1}},De.map(function(be){var Fe=be.actionId,ke=be.hasConditions,Ke=be.hasAllActionsSelected,_e=be.hasSomeActionsSelected,Ot=be.isDisplayed,it=be.isParentCheckbox,bt=be.checkboxName,Wt=be.label;return Ot?it?e.createElement(zt,{key:Fe,justifyContent:"center",alignItems:"center"},ke&&e.createElement(un,null),e.createElement(xe.BaseCheckbox,{disabled:u||ln,name:bt,"aria-label":W({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(Wt," ").concat(m)}),onValueChange:function(wt){k({target:{name:bt,value:wt}})},indeterminate:_e,value:Ke})):e.createElement(zt,{key:Fe,justifyContent:"center",alignItems:"center"},ke&&e.createElement(un,null),e.createElement(xe.BaseCheckbox,{disabled:u||ln,indeterminate:ke,name:bt,onValueChange:function(wt){te({target:{name:bt,value:wt}})},value:Ke})):e.createElement(At,{key:Fe})})),N&&e.createElement(Bt,{headerBreadCrumbs:[m,"app.components.LeftMenuLinkContainer.settings"],actions:De,isFormDisabled:u,onClosed:je,onToggle:ye})),e.createElement(yo,null,e.createElement(Xe,{onClick:ye,hasConditions:ze})))};Kt.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const pn=Kt,wn=(o,t)=>o.map(n=>{const r=Array.isArray(n.applyToProperties)&&n.applyToProperties.indexOf(t)!==-1&&n.isDisplayed;return{label:n.label,actionId:n.actionId,isActionRelatedToCurrentProperty:r}}),Bn=(0,A.default)(ee.Flex)`
  width: ${ue};
  flex-shrink: 0;
`,jn=(0,A.default)(ee.Flex)`
  width: ${We};
  height: ${rt};
  flex-shrink: 0;
`,mn=({headers:o,label:t})=>{const{formatMessage:n}=(0,ae.useIntl)(),r=n({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:t});return e.createElement(ee.Flex,null,e.createElement(jn,{alignItems:"center",paddingLeft:6},e.createElement(j.Typography,{variant:"sigma",textColor:"neutral500"},r)),o.map(i=>i.isActionRelatedToCurrentProperty?e.createElement(Bn,{justifyContent:"center",key:i.label},e.createElement(j.Typography,{variant:"sigma",textColor:"neutral500"},n({id:`Settings.roles.form.permissions.${i.label.toLowerCase()}`,defaultMessage:i.label}))):e.createElement(Bn,{key:i.label})))};mn.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const Nn=mn,Co=A.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,gn=()=>e.createElement(Co,null,"*");var kn=Object.defineProperty,bo=Object.defineProperties,Wn=Object.getOwnPropertyDescriptors,$n=Object.getOwnPropertySymbols,Un=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,hn=(o,t,n)=>t in o?kn(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,vt=(o,t)=>{for(var n in t||(t={}))Un.call(t,n)&&hn(o,n,t[n]);if($n)for(var n of $n(t))fn.call(t,n)&&hn(o,n,t[n]);return o},Te=(o,t)=>bo(o,Wn(t));const Zn=(o,t)=>o.map(n=>{const r=Array.isArray(n.subjects)&&n.subjects.indexOf(t)!==-1;return Te(vt({},n),{isDisplayed:r})});var Vn=a(87462),zn=Object.defineProperty,yn=Object.getOwnPropertySymbols,Kn=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,vn=(o,t,n)=>t in o?zn(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Hn=(o,t)=>{for(var n in t||(t={}))Kn.call(t,n)&&vn(o,n,t[n]);if(yn)for(var n of yn(t))Mt.call(t,n)&&vn(o,n,t[n]);return o};const Xn=(0,A.default)(B.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,Cn=A.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:t})=>o.colors[t]};
  }
`,Ht=o=>e.createElement(Xn,null,e.createElement(Cn,Hn({width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Ht.defaultProps={fill:"primary200"},Ht.propTypes={fill:s().string};const Yn=(0,e.memo)(Ht);var Xt=function(){return window&&window.strapi&&window.strapi.isEE?a(73071).Z:a(93485).Z}(),Yt=(0,A.default)(ee.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],ue),En=(0,A.default)(ee.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],rt),bn=(0,A.default)(B.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),Qn=(0,A.default)(B.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var t=o.isVisible,n=o.theme;return t?"4px solid ".concat(n.colors.primary200):"4px solid transparent"}),Sn=(0,A.default)(ee.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var t=o.theme;return t.spaces[4]},function(o){var t=o.level;return 145-t*36},function(o){var t=o.isCollapsable,n=o.theme;return t&&`
      `.concat(Dt,` {
        display: block;
        color: `).concat(n.colors.neutral100,`;
      }
      &:hover {
        `).concat(xt(n),`
      }
  `)},function(o){var t=o.isActive,n=o.theme;return t&&xt(n)}),Jn=A.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var t=o.theme;return t.spaces[2]},function(o){var t=o.theme;return t.spaces[2]},4/16,function(o){var t=o.theme;return t.colors.primary200}),c=function o(t){var n=t.childrenForm,r=t.isFormDisabled,i=t.recursiveLevel,u=t.pathToDataFromActionRow,m=t.propertyActions,h=t.parentName,P=t.propertyName,O=(0,ae.useIntl)(),R=O.formatMessage,N=(0,ce.$_)(),z=N.modifiedData,se=N.onChangeParentCheckbox,W=N.onChangeSimpleCheckbox,G=(0,e.useState)(null),M=(0,K.Z)(G,2),k=M[0],te=M[1],ye=function(Ne){te(function(Ve){return Ve===Ne?null:Ne})},je=(0,e.useMemo)(function(){return k?n.find(function(Le){var Ne=Le.value;return Ne===k}):null},[k,n]);return e.createElement(bn,null,e.createElement(Jn,null),n.map(function(Le,Ne){var Ve=Le.label,Ue=Le.value,Ft=Le.required,De=Le.children,ze=Ne+1<n.length,be=Array.isArray(De),Fe=k===Ue;return e.createElement(Qn,{key:Ue,isVisible:ze},e.createElement(En,null,e.createElement(Yn,{color:"primary200"}),e.createElement(ee.Flex,{style:{flex:1}},e.createElement(Sn,{level:i,isActive:Fe,isCollapsable:be},e.createElement(yt,(0,Vn.Z)({alignItems:"center",isCollapsable:be},be&&{onClick:function(){return ye(Ue)},"aria-expanded":Fe,onKeyDown:function(Ke){var _e=Ke.key;return(_e==="Enter"||_e===" ")&&ye(Ue)},tabIndex:0,role:"button"},{title:Ve}),e.createElement(j.Typography,{ellipsis:!0},Q()(Ve)),Ft&&e.createElement(gn,null),e.createElement(Dt,{$isActive:Fe}))),e.createElement(ee.Flex,{style:{flex:1}},m.map(function(ke){var Ke=ke.actionId,_e=ke.label,Ot=ke.isActionRelatedToCurrentProperty;if(!Ot)return e.createElement(At,{key:Ke});var it=[].concat((0,J.Z)(u.split("..")),[Ke,"properties",P],(0,J.Z)(h.split("..")),[Ue]),bt=ve()(z,it,!1);if(!De)return e.createElement(Yt,{key:_e,justifyContent:"center",alignItems:"center"},e.createElement(xe.BaseCheckbox,{disabled:r||Xt,name:it.join(".."),"aria-label":R({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Ve," ").concat(_e)}),onValueChange:function(en){W({target:{name:it.join(".."),value:en}})},value:bt}));var Wt=St(bt),$t=Wt.hasAllActionsSelected,wt=Wt.hasSomeActionsSelected;return e.createElement(Yt,{key:_e,justifyContent:"center",alignItems:"center"},e.createElement(xe.BaseCheckbox,{key:_e,disabled:r||Xt,name:it.join(".."),"aria-label":R({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Ve," ").concat(_e)}),onValueChange:function(en){se({target:{name:it.join(".."),value:en}})},value:$t,indeterminate:wt}))})))),je&&Fe&&e.createElement(B.Box,{paddingBottom:2},e.createElement(o,{isFormDisabled:r,parentName:"".concat(h,"..").concat(Ue),pathToDataFromActionRow:u,propertyActions:m,propertyName:P,recursiveLevel:i+1,childrenForm:je.children})))}))};c.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const d=(0,e.memo)(c),l=o=>o.reduce((n,r)=>(r.isActionRelatedToCurrentProperty&&n.push(r.actionId),n),[]),b=(o,t,n,r,i)=>{const m=l(o).reduce((h,P)=>{const O=[...n.split(".."),P,"properties",r,i],R=(0,y.get)(t,O,!1);return h[P]=R,h},{});return St(m)};var p=function(){return window&&window.strapi&&window.strapi.isEE?a(57779).Z:a(48496).Z}(),w=(0,A.default)(ee.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],ue),T=(0,A.default)(ee.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],rt,function(o){var t=o.isCollapsable,n=o.theme;return t&&`
      `.concat(Dt,` {
        display: block;
        color: `).concat(n.colors.neutral100,`;
      }
      &:hover {
        `).concat(xt(n),`
      }
  `)},function(o){var t=o.isActive,n=o.theme;return t&&xt(n)}),v=function(t){var n=t.childrenForm,r=t.label,i=t.isFormDisabled,u=t.name,m=t.required,h=t.pathToData,P=t.propertyActions,O=t.propertyName,R=t.isOdd,N=(0,ae.useIntl)(),z=N.formatMessage,se=(0,e.useState)(null),W=(0,K.Z)(se,2),G=W[0],M=W[1],k=(0,ce.$_)(),te=k.modifiedData,ye=k.onChangeCollectionTypeLeftActionRowCheckbox,je=k.onChangeParentCheckbox,Le=k.onChangeSimpleCheckbox,Ne=G===u,Ve=(0,e.useMemo)(function(){return Array.isArray(n)?n:[]},[n]),Ue=Ve.length>0,Ft=(0,e.useCallback)(function(){Ue&&M(function(ke){return ke===u?null:u})},[Ue,u]),De=function(Ke){var _e=Ke.target.value;ye(h,O,u,_e)},ze=(0,e.useMemo)(function(){return b(P,te,h,O,u)},[P,te,h,O,u]),be=ze.hasAllActionsSelected,Fe=ze.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(T,{alignItems:"center",isCollapsable:Ue,isActive:Ne,background:R?"neutral100":"neutral0"},e.createElement(ee.Flex,null,e.createElement(rn,{onChange:De,onClick:Ft,isCollapsable:Ue,isFormDisabled:i,label:r,someChecked:Fe,value:be,isActive:Ne},m&&e.createElement(gn,null),e.createElement(Dt,{$isActive:Ne})),e.createElement(ee.Flex,null,P.map(function(ke){var Ke=ke.label,_e=ke.isActionRelatedToCurrentProperty,Ot=ke.actionId;if(!_e)return e.createElement(At,{key:Ke});var it=[].concat((0,J.Z)(h.split("..")),[Ot,"properties",O,u]);if(!Ue){var bt=ve()(te,it,!1);return e.createElement(w,{key:Ot,justifyContent:"center",alignItems:"center"},e.createElement(xe.BaseCheckbox,{disabled:i||p,name:it.join(".."),"aria-label":z({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(u," ").concat(Ke)}),onValueChange:function(io){Le({target:{name:it.join(".."),value:io}})},value:bt}))}var Wt=ve()(te,it,{}),$t=St(Wt),wt=$t.hasAllActionsSelected,so=$t.hasSomeActionsSelected;return e.createElement(w,{key:Ke,justifyContent:"center",alignItems:"center"},e.createElement(xe.BaseCheckbox,{disabled:i||p,name:it.join(".."),onValueChange:function(io){je({target:{name:it.join(".."),value:io}})},"aria-label":z({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(u," ").concat(Ke)}),value:wt,indeterminate:so}))})))),Ne&&e.createElement(d,{childrenForm:Ve,isFormDisabled:i,parentName:u,pathToDataFromActionRow:h,propertyName:O,propertyActions:P,recursiveLevel:0}))};v.defaultProps={childrenForm:[],required:!1},v.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const x=(0,e.memo)(v),_=A.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Re=({availableActions:o,childrenForm:t,isFormDisabled:n,label:r,pathToData:i,propertyName:u})=>{const m=(0,e.useMemo)(()=>wn(o,u),[o,u]);return e.createElement(_,null,e.createElement(Nn,{label:r,headers:m}),e.createElement(B.Box,null,t.map(({children:h,label:P,value:O,required:R},N)=>e.createElement(x,{childrenForm:h,key:O,label:P,isFormDisabled:n,name:O,required:R,propertyActions:m,pathToData:i,propertyName:u,isOdd:N%2===0}))))};Re.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const Oe=Re,$e=A.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:t})=>t&&`border: 1px solid ${o.colors.primary600};`}
`,Je=({allActions:o,contentTypeName:t,label:n,index:r,isActive:i,isFormDisabled:u,onClickToggleCollapse:m,pathToData:h,properties:P})=>{const O=(0,e.useCallback)(()=>{m(t)},[t,m]),R=(0,e.useMemo)(()=>Zn(o,t),[o,t]);return e.createElement($e,{isActive:i},e.createElement(pn,{availableActions:R,isActive:i,isGrey:r%2===0,isFormDisabled:u,label:n,onClickToggle:O,pathToData:h}),i&&P.map(({label:N,value:z,children:se})=>e.createElement(Oe,{availableActions:R,childrenForm:se,isFormDisabled:u,label:N,pathToData:h,propertyName:z,key:z})))};Je.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const qe=Je,Ze=({actions:o,isFormDisabled:t,pathToData:n,subjects:r})=>{const[i,u]=(0,e.useState)(null),m=h=>{u(i===h?null:h)};return r.map(({uid:h,label:P,properties:O},R)=>e.createElement(qe,{allActions:o,key:h,contentTypeName:h,label:P,isActive:i===h,isFormDisabled:t,index:R,onClickToggleCollapse:m,pathToData:`${n}..${h}`,properties:O}))};Ze.defaultProps={actions:[],subjects:[]},Ze.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const Pt=(0,e.memo)(Ze),Nt=o=>o.filter(({subjects:t})=>t&&t.length);var Pn=Object.defineProperty,Tn=Object.getOwnPropertySymbols,Qt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable,kt=(o,t,n)=>t in o?Pn(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,qt=(o,t)=>{for(var n in t||(t={}))Qt.call(t,n)&&kt(o,n,t[n]);if(Tn)for(var n of Tn(t))Jt.call(t,n)&&kt(o,n,t[n]);return o};const C=o=>o.map(({actionId:t})=>t),g=(o,t)=>o.reduce((n,r)=>(Object.keys(t).forEach(i=>{const u=(0,y.get)(t,[i,r],{}),m={[i]:Gt(u)};n[r]?n[r]=qt(qt({},n[r]),m):n[r]=m}),n),{}),I=(o,t)=>{const n=C(o),r=g(n,t);return Object.keys(r).reduce((u,m)=>(u[m]=St(r[m]),u),{})};var $=function(){return window&&window.strapi&&window.strapi.isEE?a(26107).Z:a(39672).Z}(),Z=(0,A.default)(at.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],ue),he=function(t){var n=t.actions,r=t.isFormDisabled,i=t.kind,u=(0,ae.useIntl)(),m=u.formatMessage,h=(0,ce.$_)(),P=h.modifiedData,O=h.onChangeCollectionTypeGlobalActionCheckbox,R=(0,e.useMemo)(function(){return Nt(n)},[n]),N=(0,e.useMemo)(function(){return I(R,P[i])},[P,R,i]);return e.createElement(B.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:We}},e.createElement(at.Stack,{horizontal:!0,spacing:0},R.map(function(z){var se=z.label,W=z.actionId;return e.createElement(Z,{key:W,spacing:3},e.createElement(j.Typography,{variant:"sigma",textColor:"neutral500"},m({id:"Settings.roles.form.permissions.".concat(se.toLowerCase()),defaultMessage:se})),e.createElement(xe.BaseCheckbox,{disabled:r||$,onValueChange:function(M){O(i,W,M)},name:W,"aria-label":m({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:m({id:"Settings.roles.form.permissions.".concat(se.toLowerCase()),defaultMessage:se})}),value:ve()(N,[W,"hasAllActionsSelected"],!1),indeterminate:ve()(N,[W,"hasSomeActionsSelected"],!1)}))})))};he.defaultProps={actions:[]},he.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const ut=(0,e.memo)(he),ft=(0,A.default)(B.Box)`
  overflow-x: auto;
`,ne=({isFormDisabled:o,kind:t,layout:{actions:n,subjects:r}})=>{const i=Pe()([...r],"label");return e.createElement(ft,{background:"neutral0"},e.createElement(ut,{actions:n,kind:t,isFormDisabled:o}),e.createElement(Pt,{actions:n,isFormDisabled:o,pathToData:t,subjects:i}))};ne.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const Ie=(0,e.memo)(ne);var ht=a(40448);const _t=({children:o,value:t})=>e.createElement(ht.$l.Provider,{value:t},o);_t.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const On=_t;var It=a(47949),Tt=a(39272),So=a(43499),_o=Object.defineProperty,ea=Object.defineProperties,ta=Object.getOwnPropertyDescriptors,Po=Object.getOwnPropertySymbols,na=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,To=(o,t,n)=>t in o?_o(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,aa=(o,t)=>{for(var n in t||(t={}))na.call(t,n)&&To(o,n,t[n]);if(Po)for(var n of Po(t))oa.call(t,n)&&To(o,n,t[n]);return o},ra=(o,t)=>ea(o,ta(t));const sa=(o,t,n)=>o.map(r=>{const i=[...n,r.action,"properties","enabled"],u=(0,y.get)(t,i,!1),m=(0,y.get)(t,[...n,r.action,"conditions"],{}),h=Lt(m).some(P=>P);return ra(aa({},r),{isDisplayed:u,checkboxName:i.join(".."),hasSomeActionsSelected:u,value:u,hasConditions:h,label:r.displayName,actionId:r.action,pathToConditionsObject:[...n,r.action]})}),ia=o=>{const t=Object.entries(o).reduce((r,i)=>{const[u,{conditions:m}]=i;return r[u]=m,r},{});return Lt(t).some(r=>r)};var _n=function(){return window&&window.strapi&&window.strapi.isEE?a(45667).Z:a(99399).Z}(),la=A.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var t=o.theme;return t.colors.neutral150}),ca=A.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var t=o.hasConditions,n=o.disabled,r=o.theme;return t&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(n?r.colors.neutral100:r.colors.primary600,`;
    }
  `)}),Oo=function(t){var n=t.categoryName,r=t.isFormDisabled,i=t.subCategoryName,u=t.actions,m=t.pathToData,h=(0,e.useState)(!1),P=(0,K.Z)(h,2),O=P[0],R=P[1],N=(0,ce.$_)(),z=N.modifiedData,se=N.onChangeParentCheckbox,W=N.onChangeSimpleCheckbox,G=(0,ae.useIntl)(),M=G.formatMessage,k=ve()(z,m,{}),te=(0,e.useMemo)(function(){return Object.keys(k).reduce(function(De,ze){return De[ze]=Gt(k[ze]),De},{})},[k]),ye=St(te),je=ye.hasAllActionsSelected,Le=ye.hasSomeActionsSelected,Ne=function(){R(function(ze){return!ze})},Ve=function(){R(!1)},Ue=sa(u,z,m),Ft=ia(ve()(z,(0,J.Z)(m),{}));return e.createElement(e.Fragment,null,e.createElement(B.Box,null,e.createElement(ee.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(B.Box,{paddingRight:4},e.createElement(j.Typography,{variant:"sigma",textColor:"neutral600"},i)),e.createElement(la,null),e.createElement(B.Box,{paddingLeft:4},e.createElement(So.Checkbox,{name:m.join(".."),disabled:r||_n,onValueChange:function(ze){se({target:{name:m.join(".."),value:ze}})},indeterminate:Le,value:je},M({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(ee.Flex,{paddingTop:6,paddingBottom:6},e.createElement(Tt.Grid,{gap:2,style:{flex:1}},Ue.map(function(De){var ze=De.checkboxName,be=De.value,Fe=De.action,ke=De.displayName,Ke=De.hasConditions;return e.createElement(Tt.GridItem,{col:3,key:Fe},e.createElement(ca,{disabled:r||_n,hasConditions:Ke},e.createElement(So.Checkbox,{name:ze,disabled:r||_n,onValueChange:function(Ot){W({target:{name:ze,value:Ot}})},value:be},ke)))})),e.createElement(Xe,{hasConditions:Ft,onClick:Ne}))),O&&e.createElement(Bt,{headerBreadCrumbs:[n,i],actions:Ue,isFormDisabled:r,onClosed:Ve,onToggle:Ne}))};Oo.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const da=Oo,eo=({childrenForm:o,kind:t,name:n,isOpen:r,isFormDisabled:i,isWhite:u,onOpenCategory:m,pathToData:h})=>{const{formatMessage:P}=(0,ae.useIntl)(),O=()=>{m(n)},R=(0,e.useMemo)(()=>n.split("::").pop(),[n]);return e.createElement(It.Accordion,{expanded:r,onToggle:O,id:`accordion-${n}`,variant:u?"primary":"secondary"},e.createElement(It.AccordionToggle,{title:Q()(R),description:`${P({id:"Settings.permissions.category"},{category:R})} ${t==="plugins"?"plugin":t}`}),e.createElement(It.AccordionContent,null,e.createElement(B.Box,{padding:6},o.map(({actions:N,subCategoryName:z,subCategoryId:se})=>e.createElement(da,{key:z,actions:N,categoryName:R,isFormDisabled:i,subCategoryName:z,pathToData:[...h,se]})))))};eo.defaultProps={},eo.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const ua=eo,Ao=({isFormDisabled:o,kind:t,layout:n})=>{const[r,i]=(0,e.useState)(null),u=m=>{i(m===r?null:m)};return e.createElement(B.Box,{padding:6,background:"neutral0"},n.map(({category:m,categoryId:h,childrenForm:P},O)=>e.createElement(ua,{key:m,childrenForm:P,kind:t,isFormDisabled:o,isOpen:r===m,isWhite:O%2===1,name:m,onOpenCategory:u,pathToData:[t,h]})))};Ao.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const Ro=Ao,Lo=(o,t,n)=>o.find(r=>r.action===t&&r.subject===n);var pa=Object.defineProperty,ma=Object.defineProperties,ga=Object.getOwnPropertyDescriptors,Do=Object.getOwnPropertySymbols,fa=Object.prototype.hasOwnProperty,ha=Object.prototype.propertyIsEnumerable,xo=(o,t,n)=>t in o?pa(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Mo=(o,t)=>{for(var n in t||(t={}))fa.call(t,n)&&xo(o,n,t[n]);if(Do)for(var n of Do(t))ha.call(t,n)&&xo(o,n,t[n]);return o},Io=(o,t)=>ma(o,ga(t));const Fo=(o,t=[])=>o.reduce((n,r)=>(n[r.id]=t.indexOf(r.id)!==-1,n),{}),wo=({children:o},t,n="")=>o.reduce((r,i)=>{if(i.children)return Io(Mo({},r),{[i.value]:wo(i,t,`${n}${i.value}.`)});const u=t.indexOf(`${n}${i.value}`)!==-1;return r[i.value]=u,r},{}),ya=(o,t,n)=>o.reduce((r,i)=>{const u=t.properties.find(({value:m})=>m===i);if(u){const m=(0,y.get)(n,["properties",u.value],[]),h=wo(u,m);r.properties[i]=h}return r},{properties:{}}),va=(o,t)=>t.reduce((n,r)=>{const i=o.find(({uid:u})=>u===r)||null;return i&&(n[r]=i),n},{}),Bo=({subjects:o},t,n,r=[])=>t.reduce((i,u)=>{const m=u.subjects,h=va(o,m);if((0,y.isEmpty)(h))return i;const P=Object.keys(h).reduce((O,R)=>{const{actionId:N,applyToProperties:z}=u,G=h[R].properties.map(({value:ye})=>ye).every(ye=>(z||[]).indexOf(ye)===-1),M=Lo(r,N,R),k=Fo(n,(0,y.get)(M,"conditions",[]));if((0,y.isEmpty)(z)||G)return(0,y.set)(O,[R,N],{properties:{enabled:M!==void 0},conditions:k}),O;const te=ya(z,h[R],M);return(0,y.set)(O,[R,N],Io(Mo({},te),{conditions:k})),O},{});return(0,y.merge)(i,P)},{}),Ca=(o,t,n)=>o.reduce((r,i)=>{const u=Lo(n,i.action,null);return r[i.action]={properties:{enabled:u!==void 0},conditions:Fo(t,(0,y.get)(u,"conditions",[]))},r},{}),Ea=(o,t,n)=>o.reduce((r,i)=>(r[i.subCategoryId]=Ca(i.actions,t,n),r),{}),jo=(o,t,n=[])=>o.reduce((r,{categoryId:i,childrenForm:u})=>{const m=Ea(u,t,n);return r[i]=m,r},{}),No=o=>o.split(" ").join("-"),ko=(o,t)=>(0,y.chain)(o).groupBy(t).map((n,r)=>({category:r,categoryId:No(r),childrenForm:(0,y.chain)(n).groupBy("subCategory").map((i,u)=>({subCategoryName:u,subCategoryId:No(u),actions:i})).value()})).value(),ba=(o,t)=>{const{conditions:n,sections:{collectionTypes:r,singleTypes:i,plugins:u,settings:m}}=o,h={collectionTypes:r,singleTypes:i,plugins:ko(u,"plugin"),settings:ko(m,"category")},P={collectionTypes:Bo(r,r.actions||[],n,t),singleTypes:Bo(i,i.actions||[],n,t),plugins:jo(h.plugins,n,t),settings:jo(h.settings,n,t)};return{initialData:P,modifiedData:P,layouts:h}};var Sa=Object.defineProperty,Pa=Object.defineProperties,Ta=Object.getOwnPropertyDescriptors,Wo=Object.getOwnPropertySymbols,Oa=Object.prototype.hasOwnProperty,Aa=Object.prototype.propertyIsEnumerable,$o=(o,t,n)=>t in o?Sa(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,to=(o,t)=>{for(var n in t||(t={}))Oa.call(t,n)&&$o(o,n,t[n]);if(Wo)for(var n of Wo(t))Aa.call(t,n)&&$o(o,n,t[n]);return o},no=(o,t)=>Pa(o,Ta(t));const Uo=o=>Object.keys(o).reduce((t,n)=>{const r=o[n];if((0,y.isObject)(r)&&!(0,y.has)(r,"conditions"))return no(to({},t),{[n]:Uo(r)});if((0,y.isObject)(r)&&(0,y.has)(r,"conditions")&&!Lt((0,y.omit)(r,"conditions")).some(u=>u)){const u=Object.keys(r.conditions).reduce((m,h)=>(m[h]=!1,m),{});return no(to({},t),{[n]:no(to({},r),{conditions:u})})}return t[n]=r,t},{}),oo=Uo;var Ra=Object.defineProperty,La=Object.defineProperties,Da=Object.getOwnPropertyDescriptors,Go=Object.getOwnPropertySymbols,xa=Object.prototype.hasOwnProperty,Ma=Object.prototype.propertyIsEnumerable,Zo=(o,t,n)=>t in o?Ra(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Ia=(o,t)=>{for(var n in t||(t={}))xa.call(t,n)&&Zo(o,n,t[n]);if(Go)for(var n of Go(t))Ma.call(t,n)&&Zo(o,n,t[n]);return o},Fa=(o,t)=>La(o,Da(t));const Vo=(o,t)=>Object.keys(o).reduce((n,r)=>{const i=o[r];return r==="conditions"?(n[r]=i,n):(0,y.isObject)(i)?Fa(Ia({},n),{[r]:Vo(i,t)}):(n[r]=t,n)},{}),An=Vo;var wa=Object.defineProperty,Ba=Object.defineProperties,ja=Object.getOwnPropertyDescriptors,zo=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,ka=Object.prototype.propertyIsEnumerable,Ko=(o,t,n)=>t in o?wa(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,Wa=(o,t)=>{for(var n in t||(t={}))Na.call(t,n)&&Ko(o,n,t[n]);if(zo)for(var n of zo(t))ka.call(t,n)&&Ko(o,n,t[n]);return o},$a=(o,t)=>Ba(o,ja(t));const Ua={initialData:{},modifiedData:{},layouts:{}},Ga=(o,t)=>(0,de.default)(o,n=>{switch(t.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:r,actionId:i,value:u}=t,m=["modifiedData",r];Object.keys((0,y.get)(o,m)).forEach(h=>{const P=(0,y.get)(o,[...m,h,i],void 0);if(P){let O=An(P,u);if(!u&&O.conditions){const R=An(O.conditions,!1);O=$a(Wa({},O),{conditions:R})}(0,y.set)(n,[...m,h,i],O)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:r,propertyName:i,rowName:u,value:m}=t;let h=(0,y.cloneDeep)(o.modifiedData);const P=r.split(".."),O=(0,y.get)(h,P,{});Object.keys(O).forEach(R=>{if((0,y.has)(O[R],`properties.${i}`)){const N=(0,y.get)(O,[R,"properties",i,u]),z=[...P,R,"properties",i,u];if(!(0,y.isObject)(N))(0,y.set)(h,z,m);else{const se=An(N,m);(0,y.set)(h,z,se)}}}),m||(h=oo(h)),(0,y.set)(n,"modifiedData",h);break}case"ON_CHANGE_CONDITIONS":{Object.entries(t.conditions).forEach(r=>{const[i,u]=r;(0,y.set)(n,["modifiedData",...i.split(".."),"conditions"],u)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let r=(0,y.cloneDeep)(o.modifiedData);(0,y.set)(r,[...t.keys.split("..")],t.value),t.value||(r=oo(r)),(0,y.set)(n,"modifiedData",r);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:r,value:i}=t,u=[...r.split("..")];let m=(0,y.cloneDeep)(o.modifiedData);const h=(0,y.get)(m,u,{}),P=An(h,i);(0,y.set)(m,u,P),i||(m=oo(m)),(0,y.set)(n,["modifiedData"],m);break}case"RESET_FORM":{n.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{n.initialData=o.modifiedData;break}default:return n}}),ao=o=>Object.entries(o).filter(([,t])=>t).map(([t])=>t),Za=o=>{const[t,{conditions:n}]=o;return{action:t,subject:null,conditions:ao(n),properties:{}}},Va=o=>Object.values(o).reduce((t,n)=>{const r=Object.entries(n).reduce((i,u)=>{const[,{properties:{enabled:m}}]=u;if(!m)return i;const h=Za(u);return i.push(h),i},[]);return[...t,...r]},[]),Ho=o=>Object.values(o).reduce((t,n)=>{const r=Va(n);return[...t,...r]},[]),Xo=(o,t="")=>Object.entries(o).reduce((n,r)=>{const[i,u]=r;return(0,y.isObject)(u)?[...n,...Xo(u,`${t}${i}.`)]:(u&&!(0,y.isObject)(u)&&n.push(`${t}${i}`),n)},[]),za=(o,t,{conditions:n,properties:r})=>Object.entries(r).reduce((i,u)=>{const[m,h]=u;return i.properties[m]=Xo(h),i},{action:o,subject:t,conditions:ao(n),properties:{}}),Ka=(o,t,{conditions:n})=>({action:o,subject:t,properties:{},conditions:ao(n)}),Ha=(o,t)=>Object.entries(t).reduce((r,i)=>{const[u,m]=i;if(!Lt(m).some(O=>O))return r;if(!(0,y.has)(m,"properties.enabled")){const O=za(u,o,m);return[...r,O]}if(!m.properties.enabled)return r;const P=Ka(u,o,m);return r.push(P),r},[]),Yo=o=>Object.entries(o).reduce((n,r)=>{const[i,u]=r,m=Ha(i,u);return[...n,...m]},[]),Xa=o=>{const t=Ho(o.plugins),n=Ho(o.settings),r=Yo(o.collectionTypes),i=Yo(o.singleTypes);return[...t,...n,...r,...i]},Ya=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}];var Qa=Object.defineProperty,Qo=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,qa=Object.prototype.propertyIsEnumerable,Jo=(o,t,n)=>t in o?Qa(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,qo=(o,t)=>{for(var n in t||(t={}))Ja.call(t,n)&&Jo(o,n,t[n]);if(Qo)for(var n of Qo(t))qa.call(t,n)&&Jo(o,n,t[n]);return o};const ro=(0,e.forwardRef)(({layout:o,isFormDisabled:t,permissions:n},r)=>{const[{initialData:i,layouts:u,modifiedData:m},h]=(0,e.useReducer)(Ga,Ua,()=>ba(o,n)),{formatMessage:P}=(0,ae.useIntl)();(0,e.useImperativeHandle)(r,()=>({getPermissions:()=>{const W=(0,q.difference)(i.collectionTypes,m.collectionTypes),G=(0,q.difference)(i.singleTypes,m.singleTypes),M=qo(qo({},W),G);let k;return He()(M)?k=!1:k=Object.values(M).some(te=>Object.values(te).some(ye=>we()(ye,"conditions"))),{permissionsToSend:Xa(m),didUpdateConditions:k}},resetForm:()=>{h({type:"RESET_FORM"})},setFormAfterSubmit:()=>{h({type:"SET_FORM_AFTER_SUBMIT"})}}));const O=(W,G,M,k)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:W,propertyName:G,rowName:M,value:k})},R=(W,G,M)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:W,actionId:G,value:M})},N=W=>{h({type:"ON_CHANGE_CONDITIONS",conditions:W})},z=(0,e.useCallback)(({target:{name:W,value:G}})=>{h({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:W,value:G})},[]),se=(0,e.useCallback)(({target:{name:W,value:G}})=>{h({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:W,value:G})},[]);return e.createElement(On,{value:{availableConditions:o.conditions,modifiedData:m,onChangeConditions:N,onChangeSimpleCheckbox:z,onChangeParentCheckbox:se,onChangeCollectionTypeLeftActionRowCheckbox:O,onChangeCollectionTypeGlobalActionCheckbox:R}},e.createElement(V.TabGroup,{id:"tabs",label:P({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(V.Tabs,null,Ya.map(W=>e.createElement(V.Tab,{key:W.id},P({id:W.labelId,defaultMessage:W.defaultMessage})))),e.createElement(V.TabPanels,{style:{position:"relative"}},e.createElement(V.TabPanel,null,e.createElement(Ie,{layout:u.collectionTypes,kind:"collectionTypes",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(Ie,{layout:u.singleTypes,kind:"singleTypes",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(Ro,{layout:u.plugins,kind:"plugins",isFormDisabled:t})),e.createElement(V.TabPanel,null,e.createElement(Ro,{layout:u.settings,kind:"settings",isFormDisabled:t})))))});ro.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},ro.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const _a=(0,e.memo)(ro)},99399:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!0},75365:(le,F,a)=>{a.d(F,{Z:()=>e});const e=()=>"todo empty role"},56894:(le,F,a)=>{a.d(F,{Z:()=>nt});var e=a(53547),S=a(45697),s=a.n(S),q=a(94117),V=a.n(q),Ge=a(40264),we=a.n(Ge),Se=a(43546),He=a.n(Se),ae=a(33483),B=a.n(ae),A=a(49549),Y=a.n(A),Pe=a(68547),K=a.n(Pe),re=a(97132),pt=a.n(re),lt=Object.defineProperty,et=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,E=(ce,Ce,Ee)=>Ce in ce?lt(ce,Ce,{enumerable:!0,configurable:!0,writable:!0,value:Ee}):ce[Ce]=Ee,ve=(ce,Ce)=>{for(var Ee in Ce||(Ce={}))xe.call(Ce,Ee)&&E(ce,Ee,Ce[Ee]);if(et)for(var Ee of et(Ce))ee.call(Ce,Ee)&&E(ce,Ee,Ce[Ee]);return ce};const tt=({id:ce,name:Ce,description:Ee,usersCount:ot,icons:ct})=>{const{formatMessage:mt}=(0,re.useIntl)(),Xe=mt({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:ot});return e.createElement(Se.Tr,ve({key:ce},(0,Pe.onRowClick)({fn:ct[1].onClick})),e.createElement(Se.Td,{maxWidth:(0,Pe.pxToRem)(130)},e.createElement(ae.Typography,{ellipsis:!0,textColor:"neutral800"},Ce)),e.createElement(Se.Td,{maxWidth:(0,Pe.pxToRem)(250)},e.createElement(ae.Typography,{ellipsis:!0,textColor:"neutral800"},Ee)),e.createElement(Se.Td,null,e.createElement(ae.Typography,{textColor:"neutral800"},Xe)),e.createElement(Se.Td,null,e.createElement(Ge.Flex,ve({justifyContent:"flex-end"},Pe.stopPropagation),ct.map((Be,at)=>Be?e.createElement(q.Box,{key:Be.label,paddingLeft:at===0?0:1},e.createElement(A.IconButton,{onClick:Be.onClick,label:Be.label,noBorder:!0,icon:Be.icon})):null))))};tt.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired};const nt=tt},73044:(le,F,a)=>{a.d(F,{Z:()=>gt});var e=a(53547),S=a(68547),s=a(92699),q=a(63852),V=a(89326),Ge=a.n(V),we=a(62982),Se=a.n(we),He=a(56204),ae=a.n(He),B=a(54279),A=a.n(B),Y=a(64459),Pe=a(35395),K=a(43546),re=a(33483),pt=a(80117),lt=a(19631),et=a(97132),xe=a(49656),ee=a(56894),E=a(75365),ve=a(45697),tt=a.n(ve),nt=a(78384),ce=a(54451),Ce=a(15577),Ee=a(49549),ot=a(22499),ct=a(94117),mt=a(40264),Xe=a(9524),Be=a(74657),at=a.n(Be),Et=a(7228),pe=a.n(Et),j=a(12285),de=a(31652);const D=nt.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:U})=>(0,S.setHexOpacity)(U.colors.neutral800,.2)};
  padding: 0 ${({theme:U})=>U.spaces[8]};
`,ie=(0,nt.default)(mt.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,me=(0,nt.default)(Xe.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,Q=(0,nt.default)(ct.Box)`
  position: absolute;
  right: ${({theme:U})=>U.spaces[4]};
  top: ${({theme:U})=>U.spaces[4]};
`,ge=({onClose:U,isOpen:fe})=>{(0,S.useLockScroll)(fe);const{formatMessage:X}=(0,et.useIntl)();return fe?e.createElement(ce.Portal,null,e.createElement(D,{onClick:U},e.createElement(Ce.FocusTrap,{onEscape:U},e.createElement(ie,{onClick:y=>y.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:j,alt:"air-balloon"}),e.createElement(Q,null,e.createElement(Ee.IconButton,{onClick:U,"aria-label":"Close",icon:e.createElement(pe(),null)})),e.createElement(me,{spacing:6},e.createElement(re.Typography,{fontWeight:"bold",textColor:"primary600"},X({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(Xe.Stack,{spacing:2},e.createElement(re.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},X({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(re.Typography,null,X({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(ot.LinkButton,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(at(),null)},X({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:de,alt:"upgrade-arrow"}))))):null};ge.propTypes={onClose:tt().func.isRequired,isOpen:tt().bool.isRequired};const J=ge;var H=a(32104);const ue=()=>{const{roles:U,isLoading:fe}=(0,H.bF)(),X=(0,S.useQuery)(),y=decodeURIComponent(X.get("_q")||""),Ye=(0,q.ZP)(U,y,{keys:["name","description"]});return{isLoading:fe,sortedRoles:Ye}},We=()=>{const{formatMessage:U}=(0,et.useIntl)(),[fe,X]=(0,e.useState)(!1),{trackUsage:y}=(0,S.useTracking)(),{push:Ye}=(0,xe.useHistory)(),Qe=(0,e.useCallback)(Me=>{Ye(`/settings/roles/${Me}`)},[Ye]),dt=(0,e.useCallback)(()=>{X(Me=>!Me)},[]),oe=(0,e.useCallback)(()=>{y("didShowRBACUpgradeModal"),X(!0)},[y]),Ae=(0,e.useCallback)(Me=>[{onClick:dt,label:U({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(A(),null)},{onClick:()=>Qe(Me.id),label:U({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(ae(),null)},{onClick:dt,label:U({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Se(),null)}],[U,dt,Qe]);return{isModalOpen:fe,handleToggleModalForCreatingRole:oe,handleToggle:dt,getIcons:Ae}},st=()=>{const{formatMessage:U}=(0,et.useIntl)();(0,S.useFocusWhenNavigate)();const{sortedRoles:fe,isLoading:X}=ue(),{isModalOpen:y,handleToggle:Ye,handleToggleModalForCreatingRole:Qe,getIcons:dt}=We(),oe=fe.length+1,Ae=5;return e.createElement(pt.Main,null,e.createElement(S.SettingsPageTitle,{name:"Roles"}),e.createElement(Pe.HeaderLayout,{primaryAction:e.createElement(Y.Button,{onClick:Qe,startIcon:e.createElement(Ge(),null),size:"L"},U({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:U({id:"global.roles",defaultMessage:"roles"}),subtitle:U({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(Pe.ContentLayout,null,e.createElement(K.Table,{colCount:Ae,rowCount:oe,footer:e.createElement(K.TFooter,{onClick:Qe,icon:e.createElement(Ge(),null)},U({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(K.Thead,null,e.createElement(K.Tr,null,e.createElement(K.Th,null,e.createElement(re.Typography,{variant:"sigma",textColor:"neutral600"},U({id:"global.name",defaultMessage:"Name"}))),e.createElement(K.Th,null,e.createElement(re.Typography,{variant:"sigma",textColor:"neutral600"},U({id:"global.description",defaultMessage:"Description"}))),e.createElement(K.Th,null,e.createElement(re.Typography,{variant:"sigma",textColor:"neutral600"},U({id:"global.users",defaultMessage:"Users"}))),e.createElement(K.Th,null,e.createElement(lt.VisuallyHidden,null,U({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(K.Tbody,null,fe==null?void 0:fe.map(Me=>e.createElement(ee.Z,{key:Me.id,id:Me.id,name:Me.name,description:Me.description,usersCount:Me.usersCount,icons:dt(Me)})))),!oe&&!X&&e.createElement(E.Z,null)),e.createElement(J,{isOpen:y,onClose:Ye}))},gt=()=>e.createElement(S.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(st,null))},73258:(le,F,a)=>{a.d(F,{Z:()=>S});const S=[]},18290:(le,F,a)=>{a.d(F,{Z:()=>Et});var e=a(53547),S=a(30381),s=a.n(S),q=a(68547),V=a(94117),Ge=a(64459),we=a(35395),Se=a(39272),He=a(80117),ae=a(40264),B=a(9524),A=a(33483),Y=a(99136),Pe=a(78607),K=a(87760),re=a.n(K),pt=a(80831),lt=a(27361),et=a.n(lt),xe=a(41609),ee=a.n(xe),E=a(97132),ve=a(49656),tt=a(78384),nt=a(79160),ce=a(32104),Ce=a(92699),Ee=a(53209);const ct=Ee.Ry().shape({name:Ee.Z_().required(q.translatedErrors.required),description:Ee.Z_().required(q.translatedErrors.required)});var mt=a(25108),Xe=(pe,j,de)=>new Promise((D,ie)=>{var me=J=>{try{ge(de.next(J))}catch(H){ie(H)}},Q=J=>{try{ge(de.throw(J))}catch(H){ie(H)}},ge=J=>J.done?D(J.value):Promise.resolve(J.value).then(me,Q);ge((de=de.apply(pe,j)).next())});const Be=tt.default.div`
  border: 1px solid ${({theme:pe})=>pe.colors.primary200};
  background: ${({theme:pe})=>pe.colors.primary100};
  padding: ${({theme:pe})=>`${pe.spaces[2]} ${pe.spaces[4]}`};
  color: ${({theme:pe})=>pe.colors.primary600};
  border-radius: ${({theme:pe})=>pe.borderRadius};
  font-size: ${12/16}rem;
  font-width: bold;
`,at=()=>{const pe=(0,q.useNotification)(),{lockApp:j,unlockApp:de}=(0,q.useOverlayBlocker)(),{formatMessage:D}=(0,E.useIntl)(),[ie,me]=(0,e.useState)(!1),{replace:Q}=(0,ve.useHistory)(),ge=(0,e.useRef)(),{trackUsage:J}=(0,q.useTracking)(),H=(0,ve.useRouteMatch)("/settings/roles/duplicate/:id"),ue=et()(H,"params.id",null),{isLoading:We,data:rt}=(0,ce.U_)(),{permissions:st,isLoading:Ct}=(0,ce.Dq)(ue),gt=fe=>{j(),me(!0),J(ue?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,q.request)("/admin/roles",{method:"POST",body:fe})).then(X=>Xe(void 0,null,function*(){const{permissionsToSend:y}=ge.current.getPermissions();return J(ue?"didDuplicateRole":"didCreateNewRole"),X.data.id&&!ee()(y)&&(yield(0,q.request)(`/admin/roles/${X.data.id}/permissions`,{method:"PUT",body:{permissions:y}})),X})).then(X=>{me(!1),pe({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Q(`/settings/roles/${X.data.id}`)}).catch(X=>{mt.error(X),me(!1),pe({type:"warning",message:{id:"notification.error"}})}).finally(()=>{de()})},U=`${D({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${s()().format("LL")}`;return e.createElement(He.Main,null,e.createElement(q.SettingsPageTitle,{name:"Roles"}),e.createElement(pt.Formik,{initialValues:{name:"",description:U},onSubmit:gt,validationSchema:ct,validateOnChange:!1},({handleSubmit:fe,values:X,errors:y,handleReset:Ye,handleChange:Qe})=>e.createElement(q.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(we.HeaderLayout,{primaryAction:e.createElement(B.Stack,{horizontal:!0,spacing:2},e.createElement(Ge.Button,{variant:"secondary",onClick:()=>{Ye(),ge.current.resetForm()},size:"L"},D({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(Ge.Button,{onClick:fe,loading:ie,size:"L"},D({id:"global.save",defaultMessage:"Save"}))),title:D({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:D({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(q.Link,{startIcon:e.createElement(re(),null),to:"/settings/roles"},D({id:"global.back",defaultMessage:"Back"}))}),e.createElement(we.ContentLayout,null,e.createElement(B.Stack,{spacing:6},e.createElement(V.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(B.Stack,{spacing:4},e.createElement(ae.Flex,{justifyContent:"space-between"},e.createElement(V.Box,null,e.createElement(V.Box,null,e.createElement(A.Typography,{fontWeight:"bold"},D({id:"global.details",defaultMessage:"Details"}))),e.createElement(V.Box,null,e.createElement(A.Typography,{variant:"pi",textColor:"neutral600"},D({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(Be,null,D({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(Se.Grid,{gap:4},e.createElement(Se.GridItem,{col:6},e.createElement(Y.TextInput,{name:"name",error:y.name&&D({id:y.name}),label:D({id:"global.name",defaultMessage:"Name"}),onChange:Qe,value:X.name})),e.createElement(Se.GridItem,{col:6},e.createElement(Pe.Textarea,{label:D({id:"global.description",defaultMessage:"Description"}),name:"description",error:y.description&&D({id:y.description}),onChange:Qe},X.description))))),!We&&!Ct?e.createElement(V.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(nt.Z,{isFormDisabled:!1,ref:ge,permissions:st,layout:rt})):e.createElement(V.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(q.LoadingIndicatorPage,null))))))))},Et=()=>e.createElement(q.CheckPagePermissions,{permissions:Ce.Z.settings.roles.create},e.createElement(at,null))},15272:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},57779:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},73071:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},43549:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},26107:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},45667:(le,F,a)=>{a.d(F,{Z:()=>S});const S=!1},28099:(le,F,a)=>{a.d(F,{Z:()=>pe});var e=a(53547),S=a(68547),s=a(92699),q=a(89326),V=a.n(q),Ge=a(62982),we=a.n(Ge),Se=a(54279),He=a.n(Se),ae=a(56204),B=a.n(ae),A=a(64459),Y=a(35395),Pe=a(19631),K=a(80117),re=a(43546),pt=a(33483),lt=a(96486),et=a(63852),xe=a(97132),ee=a(49656),E=a(63955),ve=a(32104),tt=a(75365),nt=a(56894),ce=a(8041);const Ce={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},ot=(j,de)=>(0,ce.default)(j,D=>{switch(de.type){case"ON_REMOVE_ROLES":{D.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{D.shouldRefetchData=!0,D.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{D.shouldRefetchData=!1,D.roleToDelete=null,D.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{D.roleToDelete=de.id;break}default:return D}});var ct=(j,de,D)=>new Promise((ie,me)=>{var Q=H=>{try{J(D.next(H))}catch(ue){me(ue)}},ge=H=>{try{J(D.throw(H))}catch(ue){me(ue)}},J=H=>H.done?ie(H.value):Promise.resolve(H.value).then(Q,ge);J((D=D.apply(j,de)).next())});const mt=()=>{(0,S.useFocusWhenNavigate)();const{isLoading:j,allowedActions:{canCreate:de,canDelete:D,canRead:ie,canUpdate:me}}=(0,S.useRBAC)(s.Z.settings.roles),{getData:Q,roles:ge,isLoading:J}=(0,ve.bF)(!1),[{query:H}]=(0,S.useQueryParams)(),ue=(H==null?void 0:H._q)||"",We=(0,et.ZP)(ge,ue,{keys:["name","description"]});return(0,e.useEffect)(()=>{!j&&ie&&Q()},[j,ie,Q]),{isLoadingForPermissions:j,canCreate:de,canDelete:D,canRead:ie,canUpdate:me,isLoading:J,getData:Q,sortedRoles:We,roles:ge}},Xe=({getData:j,canCreate:de,canDelete:D,canUpdate:ie})=>{const{formatMessage:me}=(0,xe.useIntl)(),Q=(0,S.useNotification)(),[ge,J]=(0,e.useState)(!1),{push:H}=(0,ee.useHistory)(),[{selectedRoles:ue,showModalConfirmButtonLoading:We,roleToDelete:rt},st]=(0,e.useReducer)(ot,Ce),Ct=()=>ct(void 0,null,function*(){try{st({type:"ON_REMOVE_ROLES"}),yield E.be.post("/admin/roles/batch-delete",{ids:[rt]}),yield j(),st({type:"RESET_DATA_TO_DELETE"})}catch(oe){const Ae=(0,lt.get)(oe,["response","payload","data","ids"],null);if(Ae&&Array.isArray(Ae)){const Me=Ae.join(`
`);Q({type:"warning",message:Me})}else Q({type:"warning",message:{id:"notification.error"}})}X()}),gt=(0,e.useCallback)(oe=>{H(`/settings/roles/duplicate/${oe}`)},[H]),U=()=>H("/settings/roles/new"),fe=(0,e.useCallback)(oe=>{st({type:"SET_ROLE_TO_DELETE",id:oe}),X()},[]),X=()=>J(oe=>!oe),y=(0,e.useCallback)(oe=>{H(`/settings/roles/${oe}`)},[H]),Ye=(0,e.useCallback)((oe,Ae)=>{oe.preventDefault(),oe.stopPropagation(),Ae.usersCount?Q({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):fe(Ae.id)},[Q,fe]),Qe=(0,e.useCallback)((oe,Ae)=>{oe.preventDefault(),oe.stopPropagation(),gt(Ae.id)},[gt]),dt=(0,e.useCallback)(oe=>[...de?[{onClick:Ae=>Qe(Ae,oe),label:me({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(He(),null)}]:[],...ie?[{onClick:()=>y(oe.id),label:me({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(B(),null)}]:[],...D?[{onClick:Ae=>Ye(Ae,oe),label:me({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(we(),null)}]:[]],[me,Ye,Qe,y,de,ie,D]);return{handleNewRoleClick:U,getIcons:dt,selectedRoles:ue,isWarningDeleteAllOpened:ge,showModalConfirmButtonLoading:We,handleToggleModal:X,handleDeleteData:Ct}},at=()=>{const{formatMessage:j}=(0,xe.useIntl)(),{isLoadingForPermissions:de,canCreate:D,canRead:ie,canDelete:me,canUpdate:Q,isLoading:ge,getData:J,sortedRoles:H}=mt(),{handleNewRoleClick:ue,getIcons:We,isWarningDeleteAllOpened:rt,showModalConfirmButtonLoading:st,handleToggleModal:Ct,handleDeleteData:gt}=Xe({getData:J,canCreate:D,canDelete:me,canUpdate:Q}),U=H.length+1,fe=6;if(de)return e.createElement(K.Main,null,e.createElement(S.LoadingIndicatorPage,null));const X=j({id:"global.roles",defaultMessage:"roles"});return e.createElement(K.Main,null,e.createElement(S.SettingsPageTitle,{name:"Roles"}),e.createElement(Y.HeaderLayout,{primaryAction:D?e.createElement(A.Button,{onClick:ue,startIcon:e.createElement(V(),null),size:"L"},j({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:X,subtitle:j({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),ie&&e.createElement(Y.ActionLayout,{startActions:e.createElement(S.SearchURLQuery,{label:j({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:X})})}),ie&&e.createElement(Y.ContentLayout,null,e.createElement(re.Table,{colCount:fe,rowCount:U,footer:D?e.createElement(re.TFooter,{onClick:ue,icon:e.createElement(V(),null)},j({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(re.Thead,null,e.createElement(re.Tr,null,e.createElement(re.Th,null,e.createElement(pt.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.name",defaultMessage:"Name"}))),e.createElement(re.Th,null,e.createElement(pt.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.description",defaultMessage:"Description"}))),e.createElement(re.Th,null,e.createElement(pt.Typography,{variant:"sigma",textColor:"neutral600"},j({id:"global.users",defaultMessage:"Users"}))),e.createElement(re.Th,null,e.createElement(Pe.VisuallyHidden,null,j({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(re.Tbody,null,H==null?void 0:H.map(y=>e.createElement(nt.Z,{key:y.id,id:y.id,name:y.name,description:y.description,usersCount:y.usersCount,icons:We(y)})))),!U&&!ge&&e.createElement(tt.Z,null)),e.createElement(S.ConfirmDialog,{isOpen:rt,onConfirm:gt,isConfirmButtonLoading:st,onToggleDialog:Ct}))},pe=()=>e.createElement(S.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(at,null))},49475:(le,F,a)=>{a.d(F,{Z:()=>q});var e=(V,Ge,we)=>new Promise((Se,He)=>{var ae=Y=>{try{A(we.next(Y))}catch(Pe){He(Pe)}},B=Y=>{try{A(we.throw(Y))}catch(Pe){He(Pe)}},A=Y=>Y.done?Se(Y.value):Promise.resolve(Y.value).then(ae,B);A((we=we.apply(V,Ge)).next())});const q=[...strapi.features.isEnabled(strapi.features.SSO)?[{Component:()=>e(void 0,null,function*(){return yield a.e(302).then(a.bind(a,6688))}),to:"/settings/single-sign-on",exact:!0}]:[]]},12285:(le,F,a)=>{le.exports=a.p+"c3de6118ef47086ad05c.png"},31652:(le,F,a)=>{le.exports=a.p+"bd81ba6c07827282255d.png"}}]);
